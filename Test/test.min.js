var jsonPath,nNr,nP,nP2,nN,unitNr,unitNr1,unitNrdefault,nIV,iIV,navOpen,myParam,currVal,html,manNav,gesVal,ntfyJson,selectVal,myJson,nodeUpdate,responseStatus,html5,eventSource,readyIV,jsonAlarmIV,tryconnectIV,redSelection,userAgent=window.navigator.userAgent,firstRun=1,bigLength=0,isOpen=0,hasParams=1,dataT=[],dataT2=[],isittime=1,isittime2=1,NrofSlides=0,tsX=0,teX=0,tsY=0,teY=0,msTs=0,msTe=0,cooK=document.cookie,ntfyChannel="",responseTime=0,responseTime2=0,isSSE=!1,selectedChan=!1,invisible=!1,switchLocal=!0,initalRun=!0,keyString="";function addChan(){0===document.getElementById("inputChannel").offsetHeight?(document.getElementById("inputChannel").style.height="200px",document.getElementById("addBtn").classList.add("change"),enterOnInputs()):closeAddChan()}function closeAddChan(){document.getElementById("inputChannel").style.height="0",document.getElementById("addBtn").classList.remove("change"),document.getElementById("channelNa").value="",document.getElementById("channelNr").value="",document.getElementById("passWord").value=""}function submitChan(){chanName=document.getElementById("channelNa").value,chanNumber=document.getElementById("channelNr").value,chanServer=document.getElementById("channelSrv").value,password=document.getElementById("passWord").value,chanServer||(chanServer="ntfy.envs.net"),chanName&&chanNumber&&(localStorage.setItem("ntfy_"+chanName,chanServer+"/"+chanNumber+":"+password),document.getElementById("inputChannel").style.height="0"),generateChan(),closeAddChan()}function generateChan(){selectedChan=!1,html5="",Object.entries(localStorage).forEach((e=>{const[t,s]=e;"*selectedChannel"==t&&(selectVal=s)})),Object.entries(localStorage).forEach((e=>{const[t,s]=e;valueSplit=s.split(":")[0],t.includes("ntfy_")&&(newkey=t.split("_")[1],selectVal&&s==selectVal?(btnselect=redSelection?"chanBtnSelectRed":"chanBtnSelect",selectedChan=!0):btnselect="",html5+='<div class="channelItem"><button class="buttonUnit '+btnselect+'" style="text-align: center;" onclick="setChannel(this,\''+s+'\');"><div class="chanName" id="'+newkey+'">'+newkey+'</div><div class="channelName">'+valueSplit+'</div></button><button class="remove" onclick="delChan(\''+t+"','"+valueSplit+"')\">-</button></div>")})),html5?(document.getElementById("channelList").innerHTML=html5,localStorage.getItem("*selectedChannel")&&selectedChan||(clearHtml(),document.getElementById("sensorList").innerHTML='<pre class="noChan">Please select a channel.<pre>',selectedChan||(clearTimeout(readyIV),clearTimeout(tryconnectIV),localStorage.setItem("*selectedChannel",""),eventSource?.close()))):(clearTimeout(tryconnectIV),clearTimeout(readyIV),clearHtml(),document.getElementById("channelList").innerHTML="no channels added...",document.getElementById("sensorList").innerHTML='<pre class="noChan">Add a channel...\n(Click on the house symbol.)<pre>'),document.getElementById("channelNr").addEventListener("input",(function(){this.value=this.value.replace(/[.:]/g,"")})),longPressB()}function str_obj(e){e=e.split("; ");for(var t={},s=0;s<e.length;s++){var i=e[s].split("=");t[i[0]]=i[1]}return t}function setChannel(e,t){isittime&&(document.getElementById("sensorList").innerHTML='<pre class="noChan">trying to connect...<pre>',ntfyChannel=t,localStorage.setItem("*selectedChannel",ntfyChannel),chanBtns=document.querySelectorAll(".buttonUnit"),chanBtns.forEach((e=>{e.classList.remove("chanBtnSelect")})),e.classList.add("chanBtnSelect"),openChanSelection(),fetchNtfy())}function delChan(e,t){localStorage.getItem(e)&&localStorage.removeItem(e),t==selectVal&&localStorage.removeItem("*selectedChannel"),generateChan()}function checkChange(){document.getElementById("localCheck").checked?(switchLocal=!0,document.cookie="localCheck=1; expires=Fri, 31 Dec 9999 23:59:59 GMT;"):(switchLocal=!1,document.cookie="localCheck=0; expires=Fri, 31 Dec 9999 23:59:59 GMT;")}function check(){cooK.includes("localCheck=1")?(switchLocal=!0,document.getElementById("localCheck").checked=!0):(switchLocal=!1,document.getElementById("localCheck").checked=!1)}function enterOnInputs(){document.getElementById("channelNr").addEventListener("keypress",(function(e){"Enter"===e.key&&(e.preventDefault(),submitChan())})),document.getElementById("channelSrv").addEventListener("keypress",(function(e){"Enter"===e.key&&(e.preventDefault(),submitChan())}))}async function fetchNtfy(){check(),responseTime2=Date.now(),document.getElementById("unitInf").innerHTML="connecting...",localStorage.getItem("*selectedChannel")&&Object.keys(localStorage).some((e=>e.startsWith("ntfy_")))&&(clearHtml(),document.getElementById("sensorList").innerHTML='<pre class="noChan">trying to connect...<pre>',tryconnectIV=setInterval(connectionIssues,1e4)),Object.entries(localStorage).forEach((e=>{const[t,s]=e;"*selectedChannel"==t&&(ntfyChannel=s.split(":")[0],(keyString=s.split(":")[1])?keyString=convertPassphraseToKey(keyString):selectedChan&&alert("Please enter a password for the selected channel"))})),clearTimeout(readyIV),ntfyChannel&&(sendReady(1),readyIV=setInterval(sendReady,6e4),isSSE&&eventSource.close(),eventSource=new EventSource("https://"+ntfyChannel+"_json/sse"),isSSE=!0,eventSource.onmessage=e=>{let t;if(e.data.includes(ntfyChannel.split("/")[0]+"/file")&&alert("The json-message has become too long \nntfy can only handle messages <= 4096byte"),dataNtfy=JSON.parse(e.data),dataNtfy=JSON.parse(e.data),dataNtfy.message.includes("System"))t=dataNtfy.message;else{const s=decryptData(dataNtfy.message,keyString);let i={inputBuffer:new Uint8Array(s),outputBuffer:null};try{lzo1x.decompress(i),t=(new TextDecoder).decode(i.outputBuffer)}catch(e){localStorage.setItem("*selectedChannel",""),selectedChan=!1,eventSource.close(),alert("Decompression failed! \nPlease check your password."),location.reload()}}if(t)if(clearTimeout(tryconnectIV),document.getElementById("receiveNote").style.opacity=1,"killed"==dataNtfy.message)alert(newkey+" has been set to read only. Please reset device for full functionality");else{"readonly"==dataNtfy.title?(redSelection=1,generateChan(),document.getElementById("receiveNote").style.background="yellow"):(document.getElementById("receiveNote").style.background="limegreen",redSelection=0,generateChan());try{myJson=JSON.parse(t),initalRun&&(fWiFi=myJson.WiFi["IP Address"],fHost=myJson.WiFi.Hostname,initalRun=!1),switchLocal?testlocal(fWiFi,fHost):fetchJson(),responseTime2=Date.now(),clearTimeout(jsonAlarmIV),jsonAlarmIV=setTimeout(jsonLimit,9e4)}catch(e){document.getElementById("receiveNote").style.background="red"}}setTimeout(receiveNote,500)}),generateChan(),longPressS()}async function sendReady(e){invisible||getUrl("",1==e?"send1":2==e?"send2":"send"),isittime2=1}function jsonLimit(){invisible||(clearTimeout(jsonAlarmIV),clearTimeout(readyIV),readyIV=setInterval(sendReady,6e4),clearHtml(),document.getElementById("sensorList").innerHTML='<pre class="noChan">This page will refresh in a minute...<pre>',alert("Either easy2nfty became unavailable \nor you reached the limit of json updates \n(https://docs.ntfy.sh/publish/#limitations) \n...please wait a moment..."))}function receiveNote(){document.getElementById("receiveNote").style.opacity=0,document.getElementById("receiveNote").style.background="none"}async function testlocal(e,t){let s=new AbortController;setTimeout((()=>s.abort()),500);try{response=await fetch("https://"+e,{signal:s.signal})}catch(t){t.toString().includes("aborted")?fetchJson():window.open("http://"+e,"_self")}}function fetchJson(){document.cookie.includes("Snd=")||mC("Snd");try{for(Array of document.styleSheets)for(e of Array.cssRules)e.conditionText?.includes("prefers-color-scheme")&&(document.cookie.includes("Col=1")?e.media.mediaText="(prefers-color-scheme: light)":e.media.mediaText="(prefers-color-scheme: dark)")}catch(e){}urlParams=new URLSearchParams(window.location.search),null==(myParam=urlParams.get("unit"))&&(hasParams=0),someoneEn=0,isittime2&&(document.getElementById("allList").style.filter="blur(0)"),html="",html1="",html2="",html3="",dataT=[];unit=myJson.WiFi.Hostname,unitNr=myJson.System["Unit Number"],sysInfo=myJson.System;let t=`\n                        <div class="syspair"><div>Sysinfo</div><div>${unit}</div></div>\n                        <div class="syspair"><div>Local Time:</div><div>${sysInfo["Local Time"]}</div></div>\n                        <div class="syspair"><div>Uptime:</div><div>${minutesToDhm(sysInfo.Uptime)}</div></div>\n                        <div class="syspair"><div>Load:</div><div>${sysInfo.Load}%</div></div>\n                        ${sysInfo["Internal Temperature"]?`<div class="syspair">\n                                <div>Temp:</div>\n                                <div style="color: ${sysInfo["Internal Temperature"]>65?"red":"inherit"};">\n                                    ${sysInfo["Internal Temperature"]}Â°C\n                                </div>\n                                </div>`:""}\n                        <div class="syspair"><div>Free Ram:</div><div>${sysInfo["Free RAM"]}</div></div>\n                        <div class="syspair"><div>Free Stack:</div><div>${sysInfo["Free Stack"]}</div></div>\n                        <div class="syspair"><div>IP Address:</div><div>${myJson.WiFi["IP Address"]}</div></div>\n                        <div class="syspair"><div>RSSI:</div><div>${myJson.WiFi.RSSI} dBm</div></div>\n                        <div class="syspair"><div>Build:</div><div>${sysInfo.Build}</div></div>\n                        <div class="syspair"><div>Eco Mode:</div><div>${"true"===sysInfo["CPU Eco Mode"]?"on":"off"}</div></div>\n                        `,[s,i]=myJson.System["Local Time"].split(" ");i=i.split(":").slice(0,-1).join(":");let[n,l,o]=s.split("-");if(myJson.Sensors.length){for(const e of myJson.Sensors){var a="";if(sensorName=e.TaskName,sensorName.includes("?")){const[,e]=getComputedStyle(document.body).backgroundColor.match(/\d+/g);tBG=`background:#${sensorName.split("?")[1]}${"0"===e?"80":""}`,sensorName=sensorName.split("?")[0]}else tBG="";var r=changeNN(sensorName);if(htS1=' sensorset clickables" style="'+tBG+'" onclick="playSound(3000), ',htS2='<div  class="sensors" style="font-weight:bold;">'+r+"</div>",exC=[87,38,41,42].includes(e.TaskDeviceNumber),exC2=!e.Type?.includes("Display"),taskEnabled=e.TaskEnabled.toString(),"true"===taskEnabled&&!sensorName.includes("XX")&&!exC&&exC2&&!hasParams)if(e.TaskValues){someoneEn=1,firstItem=!0;for(const t of e.TaskValues){if(wasUsed=!1,"nan"==t.Value&&(t.Value=0,t.NrDecimals=0),"number"==typeof t.Value?num2Value=t.Value.toFixed(t.NrDecimals):num2Value=t.Value,iN=t.Name.toString(),itemN=iN.split("?")[0],kindN=iN.split("?")[1],kindN||(kindN=""),"H"==kindN&&(kindN="%"),"T"==kindN&&(num2Value=num2Value.toString(),num2Value=num2Value.replace(".",":"),4==t.NrDecimals&&(num2Value=num2Value.replace(/(.*)(.)(.)/,"$1.$2$3")),kindN=""),slMax=1023,slMin=0,slStep=1,bS="",1==e.TaskDeviceNumber&&(wasUsed=!0,"btnStateC"===iN&&t.Value<2||1===t.Value?bS="on":2===t.Value&&(bS="alert"),e.TaskDeviceGPIO1&&"State"===iN||"iState"===iN?("iState"===iN&&(t.Value=1==t.Value?0:1),uttonGP=sensorName+"|"+e.TaskDeviceGPIO1,html+='<div class="btnTile '+bS+htS1+"buttonClick('"+uttonGP+"', '"+t.Value+"')\">"+htS2):"pState"===iN?e.TaskDeviceGPIO1&&(uttonGP=sensorName+"?"+e.TaskDeviceGPIO1,html+='<div class="'+bS+' btnTile push sensorset" onpointerdown="playSound(3000), pushClick(\''+uttonGP+"',1)\" onpointerup=\"pushClick('"+uttonGP+'\',0)"><div id="'+sensorName+'" class="sensors" style="font-weight:bold;">'+sensorName+"</div></div>"):itemN.includes("btnState")?("ibtnState"===itemN&&(t.Value=1==t.Value?0:1),kindN&&(sensorName=sensorName+"|"+kindN),html+='<div class="btnTile '+bS+htS1+"buttonClick('"+sensorName+"', '"+t.Value+"')\">"+htS2):wasUsed=!1),33==e.TaskDeviceNumber&&!iN.includes("XX")&&!sensorName.includes("bigVal"))if(wasUsed=!0,"C"===kindN&&t.Value<2||1===t.Value?bS="on":2===t.Value&&(bS="alert"),["dButtons","vInput","pButtons"].some((t=>e.TaskName.includes(t)))&&t.Name.includes("noVal"))t.Name.includes("noValAuto")?window.innerWidth>=450&&document.cookie.includes("Two=1")&&(html+='<div class="sensorset btnTile"></div>'):html+='<div class="sensorset btnTile"></div>';else if(sensorName.includes("dButtons"))t.Value>-1&&(itemNB=itemN.split("&")[0],itemNB2=changeNN(itemNB),itemN.split(">")[1]&&getRemoteGPIOState(e.TaskNumber,itemN.split("&")[1].split(">")[0],itemN.split(">")[1],myJson.System["Unit Number"],t.ValueNumber),"A"==itemN.split("&")[1]?html+='<div class="btnTile '+bS+htS1+"getNodes('"+itemNB+'\')"><div  class="sensors nodes" style="font-weight:bold;">'+itemNB2+"</div></div>":html+='<div class="btnTile '+bS+htS1+"buttonClick('"+itemN+'\')"><div id="'+itemN+'" class="sensors" style="font-weight:bold;">'+itemNB2+"</div></div>");else if(sensorName.includes("pButtons"))t.Value>-1&&(itemNB=itemN.split("&")[0],itemNB2=changeNN(itemNB),html+='<div class="'+bS+' btnTile push sensorset" onpointerdown="playSound(3000), pushClick(\''+itemN+"',1)\" onpointerup=\"pushClick('"+itemN+'\',0)"><div id="'+itemN+'" class="sensors" style="font-weight:bold;">'+itemNB2+"</div></div>");else if(sensorName.includes("vInput"))itemN||(itemN="&nbsp;"),html+='<div class="sensorset clickables"><div class="sensors" style="font-weight:bold" onclick="getInput(this.nextElementSibling.firstChild)">'+itemN+'</div><div class="valWrap"><input type="number" class="vInputs '+e.TaskNumber+","+t.ValueNumber+'" id="'+itemN+'"name="'+sensorName+'" placeholder="'+num2Value+'" onkeydown="getInput(this)" onclick="getInput(this,1)"> <div class="kindInput">'+kindN+"</div></div></div>";else if(sensorName.includes("vSlider"))slName=iN,slKind="",(iN.match(/\?/g)||[]).length>=3&&([slName,slMin,slMax,slStep,slKind]=iN.split("?")),slName=changeNN(slName),num2Value=Number(num2Value).toFixed((slStep.toString().split(".")[1]||"").length),"noVal"==slName&&(slName="&nbsp;"),slKind||(slKind=""),"H"==slKind&&(slKind="%"),html2+='<div class="sensorset"><input type="range" min="'+slMin+'" max="'+slMax+'"  step="'+slStep+'" value="'+num2Value+'" id="'+iN+'"class="slider sL '+e.TaskNumber+","+t.ValueNumber,sensorName.includes("vSliderSw")&&(html2+=" swSlider"),sensorName.includes("nvSlider")?html2+=' noVal"><div  class="sensors" style="align-items: flex-end;"><div style="font-weight:bold;">'+slName+"</div></div></div>":html2+='"><div  class="sensors" style="align-items: flex-end;"><div style="font-weight:bold;">'+slName+'</div><div class="sliderAmount" style="text-align: right;">'+num2Value+slKind+"</div></div></div>";else if(sensorName.includes("tSlider")){4!==t.NrDecimals&&(iN="For the Time slider the value must have<br>4 decimals!"),slT1=t.Value.toFixed(4),slT2=(slT1+"").split(".")[1],slT1=Math.floor(slT1),hour1=Math.floor(slT1/60),minute1=slT1%60;const s=minute1.toString().padStart(2,"0");hour2=Math.floor(slT2/60),minute2=slT2%60;const i=minute2.toString().padStart(2,"0");iN=changeNN(iN),htmlSlider1='<input class="slTS" type="range" min="0" max="1440" step="5" value="',html2+='<div id="'+iN+'" class="slTimeSetWrap '+sensorName+" "+e.TaskNumber+","+t.ValueNumber+'" style="font-weight:bold;">'+iN+'<div class="slTimeText"> <span class="hAmount1">'+hour1+'</span><span>:</span><span class="mAmount1">'+s+'</span><span>-</span><span class="hAmount2">'+hour2+'</span><span>:</span><span class="mAmount2">'+i+'</span></div><div class="slTimeSet">'+htmlSlider1+slT1+'" id="'+iN+'L">'+htmlSlider1+slT2+'" id="'+iN+'R"></div></div>'}else if(sensorName.includes("neoPixel")){const s="h"===iN?"?H":"s"===iN?"?S":"v"===iN?"?V":"";html2+=`<input type="range" max="${"h"===iN?359:100}" min="0" value="${num2Value}" id="${sensorName}${s}" class="sL npSl ${e.TaskNumber},${t.ValueNumber} np${iN.toUpperCase()} noVal">`}else wasUsed=!1;if(sensorName.includes("bigVal")){wasUsed=!0;let t='<div class="valuesBig" style="font-weight:bold;text-align:left;">';1==firstItem&&(html3+='<div class="bigNum">',bigLength<e.TaskValues.length&&(bigLength=e.TaskValues.length)),htmlBig2='<div style="'+tBG+'" class="bigNumWrap ',iN.includes("XX")||(3!==e.TaskValues.length||e.TaskValues.some((e=>"XX"===iN))||(window.innerWidth<450||document.cookie.includes("Two=1"))&&(a="bigSpan"),sensorName.includes("bigValC")?html3+=htmlBig2+"bigC "+a+'">':html3+=htmlBig2+a+'">',htS3=t+iN+'</div><div id="',["Clock","Uhr","Zeit","Time"].some((e=>iN.includes(e)))?html3+=htS3+'clock" class="valueBig">'+i+"</div></div>":iN.toLowerCase().includes("datum")?html3+=htS3+'date" class="valueBig">'+o+"."+l.toString()+"</div></div>":iN.toLowerCase().includes("date")?html3+=htS3+'date" class="valueBig">'+l+"-"+o.toString()+"</div></div>":["year","jahr"].some((e=>iN.toLowerCase().includes(e)))?html3+=htS3+'year" class="valueBig">'+n+"</div></div>":iN.includes("noVal")?html3+=t+'</div><div class="valueBig"></span></div></div>':(itemN=changeNN(itemN),html3+=t+itemN+'</div><div class="valueBig">'+num2Value+'<span style="background:none;padding-right: 1%;">'+kindN+"</span></div></div>"))}wasUsed||(43==e.TaskDeviceNumber?firstItem&&(1===t.Value&&(bS="on"),html+='<div class="btnTile '+bS+' sensorset clickables" onclick="playSound(3000); splitOn('+e.TaskNumber+'); topF()""><div class="sensors" style="font-weight:bold;">'+sensorName+'</div><div class=even style="font-size: 20pt;">&#x23F2;&#xFE0E;</div></div></div>'):(1==firstItem&&(html1+='<div class="'+htS1+"buttonClick('"+sensorName+"')\">"+htS2),t.Name.toString().includes("XX")||(81==e.TaskDeviceNumber?html1+='<div class="cron"><div>'+itemN+'</div><div style="font-size: 10pt;">'+t.Value+"</div></div>":html1+="<div class=row><div class=odd>"+itemN+"</div><div class=even>"+num2Value+" "+kindN+"</div></div>"))),firstItem=!1}html+="</div>",html1+="</div>",html3+="</div>",document.cookie.includes("Sort=1")||(html+=html1,html1="")}else html1+='<div  class="sensorset clickables" onclick="buttonClick(\''+sensorName+'\')"><div class="sensors" style="font-weight:bold;">'+sensorName+"</div><div></div><div></div></div>",someoneEn=1,document.getElementById("sensorList").innerHTML=html}someoneEn||hasParams||(html+='<div class="sensorset clickables" onclick="splitOn(); topF()"> <div class="sensors" style="font-weight:bold;">no tasks enabled or visible...</div>')}else html+='<div class="sensorset clickables"><div  class="sensors" style="font-weight:bold;">no tasks configured...</div>';html+=html1,document.getElementById("sysInfo").innerHTML=t,document.getElementById("sensorList").innerHTML=html,document.getElementById("sliderList").innerHTML=html2,document.getElementById("bigNumber").innerHTML=html3,firstRun&&(userAgent.match(/iPhone/i)&&(document.body.style.height="101vh"),getNodes(),addEonce(),unitNrdefault=myJson.System["Unit Number"],firstRun=0),unitNr1=myJson.System["Unit Number"],hasParams||(document.getElementById("unitInf").innerHTML=unit+'<span class="numberUnit"> ('+myJson.WiFi.RSSI+")</span>",document.getElementById("unitT").innerHTML=unit),getNodes(),paramS(),changeCss(),resizeText(),longPressB()}async function getRemoteGPIOState(e,t,s,i,n){return await getUrl(`control?cmd=SendTo,${t},"SendTo,${i},'taskvalueset,${e},${n},%5BPlugin%23GPIO%23Pinstate%23${s}%5D'"`)}function changeNN(e){return e.replace(/_/g," ").replace(/\./g,"<br>")}function changeCss(){let e,t,s,i="auto ",n=null;document.querySelectorAll("input[type=range]").length?document.getElementById("allList").classList.remove("allExtra"):document.getElementById("allList").classList.add("allExtra");var l=document.querySelectorAll(".bigNum"),o=document.getElementById("sensorList"),a=o.getElementsByClassName("sensorset").length;if(s=0,l.length||(s=a),4==bigLength||s>9)t=i+i+i+i,e=4;else if(3==bigLength||s>4)t=i+i+i,e=3;else if(2==bigLength||s>1)t=i+i,e=2;else if(1==bigLength||s<2){if(t=i,n="important",l.length)for(let e=0;e<l.length;++e)l[e].classList.add("bigNumOne");e=1}else t=i+i,e=2;if(widthLimit=150*e+e*(window.innerHeight/100),window.innerWidth<widthLimit||document.cookie.includes("Two=1")){if(l.length)for(let e=0;e<l.length;++e)l[e].style.cssText="display: grid; grid-template-columns: auto auto;";1==bigLength||0==bigLength&&1==a?(e=1,t=i,n="important"):(e=2,t=i+i)}if(o.style.setProperty("grid-template-columns",t,n),a%e!=0&&1!=e){calcTile=e-(a-e*Math.floor(a/e));for(let e=1;e<=calcTile;e++)html+='<div class="sensorset"></div>'}document.getElementById("sensorList").innerHTML=html,bigLength=0}function paramS(){document.querySelectorAll(".slTS").forEach((e=>{e.addEventListener("input",updateSlTS),e.addEventListener("change",sliderChTS),e.addEventListener("pointerup",(e=>{iIV=setTimeout(blurInput,1e3)}))})),document.querySelectorAll(".sL").forEach((e=>{e.addEventListener("input",updateSlider),e.addEventListener("change",sliderChange),e.addEventListener("pointerup",(e=>{iIV=setTimeout(blurInput,1e3)}))})),neoS=document.querySelectorAll(".npS"),neoS.forEach((e=>{hVal=document.getElementById(e.id.split("?")[0]+"?H")?.value,vVal=document.getElementById(e.id.split("?")[0]+"?V")?.value||20,vVal<20&&(vVal=20),e.style.backgroundImage="linear-gradient(to right, hsl(0,0%,"+vVal+"%),hsl("+hVal+",100%,50%))"}))}function addEonce(){document.addEventListener("touchstart",(e=>{msTs=Date.now(),tsX=e.changedTouches[0].screenX,tsY=e.changedTouches[0].screenY})),document.addEventListener("touchend",(e=>{msTe=Date.now(),teX=e.changedTouches[0].screenX,teY=e.changedTouches[0].screenY,checkDirection()})),document.addEventListener("mousemove",(e=>{manNav||navOpen||e.clientX<10&&-280===document.getElementById("mySidenav").offsetLeft&&openNav()})),document.getElementById("mySidenav").addEventListener("mouseleave",(e=>{manNav||closeNav()}))}function checkDirection(){touchtime=msTe-msTs,touchDistX=teX-tsX,touchDistY=teY-tsY,teX<tsX&&navOpen&&Math.abs(touchDistX)>40&&Math.abs(touchDistY)<30&&touchtime<250&&closeNav(),teX>tsX&&!navOpen&&Math.abs(touchDistX)>40&&Math.abs(touchDistY)<30&&touchtime<250&&openNav()}function updateSlTS(e){isittime=0,slider=e.target,"L"==slider.id.slice(-1)?nuM=1:nuM=2;const t=slider.parentElement.closest(".slTimeSetWrap").firstElementChild.querySelector(".hAmount"+nuM),s=slider.parentElement.closest(".slTimeSetWrap").firstElementChild.querySelector(".mAmount"+nuM);var i=Math.floor(slider.value/60);const n=(slider.value%60).toString().padStart(2,"0");t.textContent=i,s.textContent=n}function updateSlider(e){if(NrofSlides++,isittime=0,slider=e.target,currVal=slider.attributes.value.nodeValue,slKind=slider.id.split("?")[4],!slider.className.includes("noVal")){const t=slider.closest("div.sensorset").querySelector(".sliderAmount");slKind||(slKind=""),"H"==slKind&&(slKind="%"),slA=Number(e.target.value).toFixed(void 0!==e.target.step.split(".")[1]&&e.target.step.split(".")[1].length)+slKind,t.textContent=slA}"npSl"==slider.classList[1]&&(sliderId=slider.id.split("?")[0],hVal=document.getElementById(sliderId+"?H")?.value,sVal=document.getElementById(sliderId+"?S")?.value,vVal=document.getElementById(sliderId+"?V")?.value,gesVal=[hVal,sVal,vVal],vVal=vVal??0,sVal&&hVal&&(vVal<20&&(vVal=20),sGrad=document.getElementById(sliderId+"?S"),sGrad.style.backgroundImage="linear-gradient(to right, hsl(0,0%,"+vVal+"%),hsl("+hVal+",100%,50%))"))}function sliderChTS(e){playSound(4e3),slider=e.target;const t=slider.parentNode.parentNode;if(slider.id==t.id+"L")var s=document.getElementById(t.id+"R");else s=document.getElementById(t.id+"L");unitNr===unitNr1?slider.id==t.id+"L"?getUrl("control?cmd=taskvalueset,"+t.classList[2]+","+e.target.value+"."+s.value.toString().padStart(4,"0")+" control?cmd=event,"+t.classList[1]+"Event="+t.classList[2].split(",")[1],"dualcommand"):getUrl("control?cmd=taskvalueset,"+t.classList[2]+","+s.value+"."+e.target.value.toString().padStart(4,"0")+" control?cmd=event,"+t.classList[1]+"Event="+t.classList[2].split(",")[1],"dualcommand"):(slider.id==t.id+"L"?getUrl("control?cmd=SendTo,"+nNr+',"taskvalueset,'+t.classList[2]+","+e.target.value+"."+s.value.toString().padStart(4,"0")+'"'):getUrl("control?cmd=SendTo,"+nNr+',"taskvalueset,'+t.classList[2]+","+s.value+"."+e.target.value.toString().padStart(4,"0")+'"'),getUrl("control?cmd=SendTo,"+nNr+',"event,'+t.classList[1]+"Event="+t.classList[2].split(",")[1]+'"'))}function sliderChange(e){playSound(4e3),slider=e.target,maxVal=parseFloat(slider.attributes.max.nodeValue),minVal=parseFloat(slider.attributes.min.nodeValue),OnOff="",slA=e.target.value,1==NrofSlides&&"swSlider"==slider.classList[3]&&(df=1*(maxVal-minVal)/10,slA>maxVal-df&&currVal!==maxVal&&(slA=maxVal,OnOff=",1",isittime=1,setTimeout(fetchJson,500)),slA<minVal+df&&currVal!==minVal&&(slA=minVal,OnOff=",0",isittime=1,setTimeout(fetchJson,500))),(slider.id.match(/\?/g)||[]).length>=3||"npSl"==slider.classList[1]?sliderId=slider.id.split("?")[0]:sliderId=slider.id,gesVal&&(gesVal=gesVal.filter((e=>e))),unitNr===unitNr1?"npSl"!=slider.classList[1]?getUrl("control?cmd=taskvalueset,"+slider.classList[2]+","+slA+" control?cmd=event,"+sliderId+"Event="+slA+OnOff,"dualcommand"):getUrl("control?cmd=taskvalueset,"+slider.classList[2]+","+slA+" control?cmd=event,"+sliderId+"Event="+gesVal,"dualcommand"):(getUrl("control?cmd=SendTo,"+nNr+',"taskvalueset,'+slider.classList[2]+","+slA+'"'),"npSl"!=slider.classList[1]?getUrl("control?cmd=SendTo,"+nNr+',"event,'+sliderId+"Event="+slA+OnOff+'"'):getUrl("control?cmd=SendTo,"+nNr+',"event,'+sliderId+"Event="+gesVal+'"')),clearTimeout(iIV),iIV=setTimeout(blurInput,1e3),NrofSlides=0}function buttonClick(e,t){e.split("&")[1]?(utton2=e.split("&")[0],nNr2=e.split("&")[1].split(">")[0],e.split(">")[1]&&!e.split(">")[1].endsWith("L")?getUrl("control?cmd=SendTo,"+nNr2+',"GPIOToggle,'+e.split(">")[1]+'"'):getUrl("control?cmd=SendTo,"+nNr2+',"event,'+utton2+'Event"')):e.split("|")[1]?(gpioNr=e.split("|")[1],uN=e.split("|")[0],gS=1==t?0:1,getUrl(unitNr===unitNr1?"control?cmd=gpio,"+gpioNr+","+gS+" control?cmd=event,"+uN+"Event":"control?cmd=SendTo,"+nNr+',"gpio,'+gpioNr+","+gS+'" control?cmd=SendTo,'+nNr+',"event,'+uN+'Event"',"dualcommand")):getUrl(unitNr===unitNr1?"control?cmd=event,"+e+"Event":"control?cmd=SendTo,"+nNr+',"event,'+e+'Event"'),setTimeout(fetchJson,400)}function pushClick(e,t){0==t?(isittime=1,playSound(1e3)):isittime=0,e.split("&")[1]?(utton2=e.split("&")[0],nNr2=e.split("&")[1],getUrl("control?cmd=SendTo,"+nNr2+',"event,'+utton2+"Event="+t+'"')):getUrl(unitNr===unitNr1?"control?cmd=event,"+e+"Event="+t:"control?cmd=SendTo,"+nNr+',"event,'+e+"Event="+t+'"')}function getInput(e,t){"click"===event.type&&(isittime=0,iIV=setTimeout(blurInput,8e3),e.addEventListener("blur",(e=>{clearTimeout(iIV),isittime=1}))),e.value.length>12&&(e.value=e.value.slice(0,12)),"Enter"===event.key||"click"===event.type&&!t?(isittime=1,e.value?(playSound(4e3),getUrl(unitNr===unitNr1?"control?cmd=taskvalueset,"+e.classList[1]+","+e.value:"control?cmd=SendTo,"+nNr+',"taskvalueset,'+e.classList[1]+","+e.value+'"'),buttonClick(e.id)):setTimeout(fetchJson,400),clearTimeout(iIV)):"Escape"===event.key?document.getElementById(e.id).value="":(clearTimeout(iIV),iIV=setTimeout(blurInput,5e3))}function blurInput(e){isittime=1}function openNav(e){navOpen=1,e&&(manNav=1),-280===document.getElementById("mySidenav").offsetLeft?document.getElementById("mySidenav").style.left="0":closeNav()}function closeNav(){manNav=0,navOpen=0,clearInterval(nIV),document.getElementById("mySidenav").style.left="-280px"}function openSys(){0===document.getElementById("sysInfo").offsetHeight?(document.getElementById("menueWrap1").style.flexShrink="0",document.getElementById("sysInfo").style.height="180px"):(document.getElementById("sysInfo").style.height="0",document.getElementById("menueWrap1").style.flexShrink="999")}function getNodes(e,t,s){let i="";nInf=myJson.nodes;let n=-1;if(myJson.nodes.forEach((s=>{n++,s.nr==myParam&&hasParams&&(nodeChange(n),hasParams=0),s.nr===unitNr?styleN="&#183;&#xFE0E;":styleN="",i+='<div class="menueItem"><div class="serverUnit" style="text-align: center;">'+styleN+'</div><div id="'+s.name+'" class="nc" onclick="nodeChange('+n+');">'+s.name+'<span class="numberUnit">'+s.nr+"</span></div></div>",(e||t)&&(t?s.nr===unitNr1?fetch("control?cmd=event,"+e+"Long"):getUrl("control?cmd=SendTo,"+s.nr+',"event,'+e+'Long"'):isittime&&(s.nr===unitNr1?fetch("control?cmd=event,"+e+"Event"):getUrl("control?cmd=SendTo,"+s.nr+',"event,'+e+'Event"')))})),n=0,document.getElementById("menueList").innerHTML=i,hasParams){let e='<div class="sensorset clickables"><div  class="sensors" style="font-weight:bold;">can not find node # '+myParam+"...</div></div>";document.getElementById("sensorList").innerHTML=e,changeCss(),hasParams=0}}function nodeChange(e){if(nInf=nInf[e],nInf){if(nNr=nInf.nr,nN=nInf.name,jsonPath=window[nInf.ip],unitNrdefault==nNr){var t=document.location.href;window.history.pushState({},"",t.split("?")[0])}else window.history.replaceState(null,null,"?unit="+nNr);getUrl(nInf.ip,"change_node"),dataT2=[]}window.innerWidth<450&&0===document.getElementById("sysInfo").offsetHeight&&closeNav()}function resizeText(){const e=({clientWidth:e,clientHeight:t,scrollWidth:s,scrollHeight:i})=>s>e||i>t;(({element:t,elements:s,minSize:i=10,maxSize:n=115,step:l=1,unit:o="pt"})=>{(s||[t]).forEach((t=>{let s=i,a=!1;const r=t.parentNode;for(;!a&&s<n;)t.style.fontSize=`${s}${o}`,a=e(r),a||(s+=l);t.style.fontSize=`${s-l-1}${o}`,t.style.lineHeight="0.75"}))})({elements:document.querySelectorAll(".valueBig"),step:1})}function launchFs(e){e.requestFullscreen()}function openChanSelection(){isOpen?(document.getElementById("framie").style.right="-280px",isOpen=0,closeAddChan()):(document.getElementById("framie").style.right="0",isOpen=1)}function topF(){document.body.scrollTop=0,document.documentElement.scrollTop=0}function longPressS(){document.getElementById("closeBtn").addEventListener("long-press",(function(e){e.preventDefault(),mC("Snd")})),document.getElementById("nOpen").addEventListener("long-press",(function(e){e.preventDefault(),mC("Sort")})),document.getElementById("openSys").addEventListener("long-press",(function(e){e.preventDefault(),mC("Two")})),document.getElementById("unitId").addEventListener("long-press",(function(e){e.preventDefault(),mC("Col")}))}function mC(e){const t=1==(document.cookie.match(`(^|;)\\s*${e}\\s*=\\s*([^;]+)`)?.pop()||"");playSound(t?500:900),document.cookie=`${e}=${t?0:1}; expires=Fri, 31 Dec 9999 23:59:59 GMT; path=/; SameSite=Lax;`}function longPressB(){let e=!1;document.querySelectorAll(".clickables").forEach((t=>{t.addEventListener("long-press",(function(s){s.preventDefault();const i=t.querySelector(".sensors"),n=t.querySelector(".nodes");n?getNodes(n.textContent,"1"):i.id.split("&")[1]?(utton2=i.id.split("&")[0],nNr2=i.id.split("&")[1].split(">")[0],i.id.split(">")[1].endsWith("L")?getUrl("control?cmd=SendTo,"+nNr2+',"GPIOToggle,'+i.id.split(">")[1].split("L")[0]+'"'):getUrl("control?cmd=SendTo,"+nNr2+',"event,'+utton2+'Long"'),setTimeout(fetchJson,400)):(unitNr!==unitNr1||e?(getUrl("control?cmd=SendTo,"+nNr+',"event,'+i.textContent+'Long"'),e=!0):(getUrl("control?cmd=event,"+i.textContent+"Long"),e=!0),setTimeout(fetchJson,400)),playSound(1e3),isittime=0,iIV=setTimeout(blurInput,600)}))}))}function minutesToDhm(e){const t=Math.floor(e/1440),s=Math.floor(e%1440/60),i=e%60,n=(e,t)=>e>0?`${e} ${t}${1===e?"":"s"} `:"";return n(t,"day")+n(s,"hour")+n(i,"minute")}function playSound(e){(document.cookie.includes("Snd=1")||e<1e3)&&(isittime||3e3!==e)&&(c=new AudioContext,o=c.createOscillator(),g=c.createGain(),frequency=e,o.frequency.value=frequency,o.type="sawtooth",o.connect(g),g.connect(c.destination),g.gain.setValueAtTime(.05,0),o.start(0),g.gain.exponentialRampToValueAtTime(1e-5,c.currentTime+.01),o.stop(c.currentTime+.01))}async function getUrl(e,t){if(Date.now()-responseTime>1e4){t||(t="command");let s=new AbortController;setTimeout((()=>s.abort()),5e3);try{message="https://"+ntfyChannel+"?title="+encodeURIComponent(t)+"&message="+(e?encodeURIComponent(encryptData(e)):""),response=await fetch(message,{signal:s.signal,method:"POST",headers:{Cache:"no"}}),429==response.status?(clearTimeout(readyIV),readyIV=setInterval(sendReady,6e4),isittime2=0,firstRun||(document.getElementById("allList").style.filter="blur(5px)"),alert("You reached the limit of commands, please wait a moment... \n(https://docs.ntfy.sh/publish/#limitations)"),document.getElementById("receiveNote").style.opacity=1,document.getElementById("receiveNote").style.background="red",setTimeout(receiveNote,500)):200==response.status&&(isittime2=1,document.getElementById("receiveNote").style.opacity=1,document.getElementById("receiveNote").style.background="blue",setTimeout(receiveNote,500))}catch(e){clearHtml(),document.getElementById("sensorList").innerHTML='<pre class="noChan">Connection error!\nDid you enter the correct server?\nIs your Server online and reachable?\nTry to reload this page<pre>'}}}function connectionIssues(){sendReady(1),Date.now()-responseTime2>8e4?(clearHtml(),document.getElementById("sensorList").innerHTML='<img src="https://legendofmi.com/images/animatedgifs/threeheaded.gif" style="box-shadow: none; image-rendering: pixelated" width="80" height="80" alt="Three-headed Monkey">'):Date.now()-responseTime2>7e4?(clearHtml(),document.getElementById("sensorList").innerHTML='<pre class="noChan">If you are still here reading this you should probably give up and enjoy a walk in the park.<pre>'):Date.now()-responseTime2>6e4?(clearHtml(),document.getElementById("sensorList").innerHTML='<pre class="noChan">Ok...enough of this!\nDevelopers for good software are hard to find these days.\nInsert disk #22 to start another program.<pre>'):Date.now()-responseTime2>5e4?(clearHtml(),document.getElementById("sensorList").innerHTML='<pre class="noChan">I was joking. :)<pre>'):Date.now()-responseTime2>4e4?(clearHtml(),document.getElementById("sensorList").innerHTML='<pre class="noChan">Look behind you!\nA three headed monkey!<pre>'):Date.now()-responseTime2>3e4?(clearHtml(),document.getElementById("sensorList").innerHTML='<pre class="noChan">...or a cup of grog...<pre>'):Date.now()-responseTime2>2e4?(clearHtml(),document.getElementById("sensorList").innerHTML='<pre class="noChan">...hmmmm...\nStill no word from easy2ntfy.\nMaybe you should go and get yourself a coffee...<pre>'):Date.now()-responseTime2>1e4&&(clearHtml(),document.getElementById("sensorList").innerHTML='<pre class="noChan">...still trying to connect...\nIs easy2ntfy actually running?\nIt is also possible, that you hit the message limit. \n(if so easy2ntfy will be back in a minute)<pre>')}function clearHtml(){document.getElementById("sensorList").innerHTML="",document.getElementById("sliderList").innerHTML="",document.getElementById("bigNumber").innerHTML=""}function strToByteArray(e){const t=new Uint8Array(e.length);for(let s=0;s<e.length;s++)t[s]=e.charCodeAt(s);return t}function encryptData(e){strToByteArray(e);const t=CryptoJS.lib.WordArray.random(16),s=CryptoJS.AES.encrypt(e,CryptoJS.enc.Utf8.parse(keyString),{iv:t,padding:CryptoJS.pad.Pkcs7,mode:CryptoJS.mode.CBC});return CryptoJS.enc.Base64.stringify(t.concat(s.ciphertext))}function decryptData(e,t){try{let s=CryptoJS.enc.Base64.parse(e),i=CryptoJS.enc.Utf8.parse(t),n=CryptoJS.lib.WordArray.create(s.words.slice(0,4),16),l=CryptoJS.lib.WordArray.create(s.words.slice(4)),o=CryptoJS.AES.decrypt({ciphertext:l},i,{iv:n}),a=new Uint8Array(o.sigBytes);for(let e=0;e<o.sigBytes;e++)a[e]=o.words[e>>>2]>>>24-e%4*8&255;return a}catch(e){throw e}}function convertPassphraseToKey(e){let t="";if(e.length<16){for(;t.length<16;)t+=e;t=t.substring(0,16)}else t=e.substring(0,16);return t}document.addEventListener("visibilitychange",(()=>{"visible"===document.visibilityState?(invisible=!1,isittime2&&(clearTimeout(readyIV),readyIV=setInterval(sendReady,6e4),sendReady(2))):(invisible=!0,clearTimeout(jsonAlarmIV),isittime2&&getUrl("","stop"))}));var lzo1x=function(){"use strict";var e=new function(){this.blockSize=131072,this.minNewSize=this.blockSize,this.maxSize=0,this.OK=0,this.INPUT_OVERRUN=-4,this.OUTPUT_OVERRUN=-5,this.LOOKBEHIND_OVERRUN=-6,this.EOF_FOUND=-999,this.ret=0,this.buf=null,this.buf32=null,this.out=new Uint8Array(262144),this.cbl=0,this.ip_end=0,this.op_end=0,this.t=0,this.ip=0,this.op=0,this.m_pos=0,this.m_len=0,this.m_off=0,this.dv_hi=0,this.dv_lo=0,this.dindex=0,this.ii=0,this.jj=0,this.tt=0,this.v=0,this.dict=new Uint32Array(16384),this.emptyDict=new Uint32Array(16384),this.skipToFirstLiteralFun=!1,this.returnNewBuffers=!0,this.setBlockSize=function(e){return"number"==typeof e&&!isNaN(e)&&parseInt(e)>0&&(this.blockSize=parseInt(e),!0)},this.setOutputSize=function(e){return"number"==typeof e&&!isNaN(e)&&parseInt(e)>0&&(this.out=new Uint8Array(parseInt(e)),!0)},this.setReturnNewBuffers=function(e){this.returnNewBuffers=!!e},this.applyConfig=function(t){void 0!==t&&(void 0!==t.outputSize&&e.setOutputSize(t.outputSize),void 0!==t.blockSize&&e.setBlockSize(t.blockSize))},this.ctzl=function(e){var t;return 1&e?t=0:(t=1,0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),t-=1&e),t},this.extendBuffer=function(){var e=new Uint8Array(this.minNewSize+(this.blockSize-this.minNewSize%this.blockSize));e.set(this.out),this.out=e,this.cbl=this.out.length},this.match_next=function(){this.minNewSize=this.op+3,this.minNewSize>this.cbl&&this.extendBuffer(),this.out[this.op++]=this.buf[this.ip++],this.t>1&&(this.out[this.op++]=this.buf[this.ip++],this.t>2&&(this.out[this.op++]=this.buf[this.ip++])),this.t=this.buf[this.ip++]},this.match_done=function(){return this.t=3&this.buf[this.ip-2],this.t},this.copy_match=function(){this.t+=2,this.minNewSize=this.op+this.t,this.minNewSize>this.cbl&&this.extendBuffer();do{this.out[this.op++]=this.out[this.m_pos++]}while(--this.t>0)},this.copy_from_buf=function(){this.minNewSize=this.op+this.t,this.minNewSize>this.cbl&&this.extendBuffer();do{this.out[this.op++]=this.buf[this.ip++]}while(--this.t>0)},this.match=function(){for(;;){if(this.t>=64)this.m_pos=this.op-1-(this.t>>2&7)-(this.buf[this.ip++]<<3),this.t=(this.t>>5)-1,this.copy_match();else if(this.t>=32){if(this.t&=31,0===this.t){for(;0===this.buf[this.ip];)this.t+=255,this.ip++;this.t+=31+this.buf[this.ip++]}this.m_pos=this.op-1-(this.buf[this.ip]>>2)-(this.buf[this.ip+1]<<6),this.ip+=2,this.copy_match()}else if(this.t>=16){if(this.m_pos=this.op-((8&this.t)<<11),this.t&=7,0===this.t){for(;0===this.buf[this.ip];)this.t+=255,this.ip++;this.t+=7+this.buf[this.ip++]}if(this.m_pos-=(this.buf[this.ip]>>2)+(this.buf[this.ip+1]<<6),this.ip+=2,this.m_pos===this.op)return this.state.outputBuffer=!0===this.returnNewBuffers?new Uint8Array(this.out.subarray(0,this.op)):this.out.subarray(0,this.op),this.EOF_FOUND;this.m_pos-=16384,this.copy_match()}else this.m_pos=this.op-1-(this.t>>2)-(this.buf[this.ip++]<<2),this.minNewSize=this.op+2,this.minNewSize>this.cbl&&this.extendBuffer(),this.out[this.op++]=this.out[this.m_pos++],this.out[this.op++]=this.out[this.m_pos];if(0===this.match_done())return this.OK;this.match_next()}},this.decompress=function(e){const t=Date.now();if(this.state=e,this.buf=this.state.inputBuffer,this.cbl=this.out.length,this.ip_end=this.buf.length,this.t=0,this.ip=0,this.op=0,this.m_pos=0,this.skipToFirstLiteralFun=!1,this.buf[this.ip]>17)if(this.t=this.buf[this.ip++]-17,this.t<4){if(this.match_next(),this.ret=this.match(),this.ret!==this.OK)return this.ret===this.EOF_FOUND?this.OK:this.ret}else this.copy_from_buf(),this.skipToFirstLiteralFun=!0;for(;;){if(Date.now()-t>1e3)throw new Error("Decompression timed out");if(this.skipToFirstLiteralFun)this.skipToFirstLiteralFun=!1;else{if(this.t=this.buf[this.ip++],this.t>=16){if(this.ret=this.match(),this.ret!==this.OK)return this.ret===this.EOF_FOUND?this.OK:this.ret;continue}if(0===this.t){for(;0===this.buf[this.ip];)this.t+=255,this.ip++;this.t+=15+this.buf[this.ip++]}this.t+=3,this.copy_from_buf()}if(this.t=this.buf[this.ip++],this.t<16){if(this.m_pos=this.op-2049,this.m_pos-=this.t>>2,this.m_pos-=this.buf[this.ip++]<<2,this.minNewSize=this.op+3,this.minNewSize>this.cbl&&this.extendBuffer(),this.out[this.op++]=this.out[this.m_pos++],this.out[this.op++]=this.out[this.m_pos++],this.out[this.op++]=this.out[this.m_pos],0===this.match_done())continue;this.match_next()}if(this.ret=this.match(),this.ret!==this.OK)return this.ret===this.EOF_FOUND?this.OK:this.ret}return this.OK},this._compressCore=function(){for(this.ip_start=this.ip,this.ip_end=this.ip+this.ll-20,this.jj=this.ip,this.ti=this.t,this.ip+=this.ti<4?4-this.ti:0,this.ip+=1+(this.ip-this.jj>>5);!(this.ip>=this.ip_end);)if(this.dv_lo=this.buf[this.ip]|this.buf[this.ip+1]<<8,this.dv_hi=this.buf[this.ip+2]|this.buf[this.ip+3]<<8,this.dindex=((17053*this.dv_lo>>>16)+17053*this.dv_hi+6180*this.dv_lo&65535)>>>2,this.m_pos=this.ip_start+this.dict[this.dindex],this.dict[this.dindex]=this.ip-this.ip_start,(this.dv_hi<<16)+this.dv_lo==(this.buf[this.m_pos]|this.buf[this.m_pos+1]<<8|this.buf[this.m_pos+2]<<16|this.buf[this.m_pos+3]<<24)){if(this.jj-=this.ti,this.ti=0,this.v=this.ip-this.jj,0!==this.v)if(this.v<=3){this.out[this.op-2]|=this.v;do{this.out[this.op++]=this.buf[this.jj++]}while(--this.v>0)}else{if(this.v<=18)this.out[this.op++]=this.v-3;else{for(this.tt=this.v-18,this.out[this.op++]=0;this.tt>255;)this.tt-=255,this.out[this.op++]=0;this.out[this.op++]=this.tt}do{this.out[this.op++]=this.buf[this.jj++]}while(--this.v>0)}if(this.m_len=4,this.buf[this.ip+this.m_len]===this.buf[this.m_pos+this.m_len])do{if(this.m_len+=1,this.buf[this.ip+this.m_len]!==this.buf[this.m_pos+this.m_len])break;if(this.m_len+=1,this.buf[this.ip+this.m_len]!==this.buf[this.m_pos+this.m_len])break;if(this.m_len+=1,this.buf[this.ip+this.m_len]!==this.buf[this.m_pos+this.m_len])break;if(this.m_len+=1,this.buf[this.ip+this.m_len]!==this.buf[this.m_pos+this.m_len])break;if(this.m_len+=1,this.buf[this.ip+this.m_len]!==this.buf[this.m_pos+this.m_len])break;if(this.m_len+=1,this.buf[this.ip+this.m_len]!==this.buf[this.m_pos+this.m_len])break;if(this.m_len+=1,this.buf[this.ip+this.m_len]!==this.buf[this.m_pos+this.m_len])break;if(this.m_len+=1,this.buf[this.ip+this.m_len]!==this.buf[this.m_pos+this.m_len])break;if(this.ip+this.m_len>=this.ip_end)break}while(this.buf[this.ip+this.m_len]===this.buf[this.m_pos+this.m_len]);if(this.m_off=this.ip-this.m_pos,this.ip+=this.m_len,this.jj=this.ip,this.m_len<=8&&this.m_off<=2048)this.m_off-=1,this.out[this.op++]=this.m_len-1<<5|(7&this.m_off)<<2,this.out[this.op++]=this.m_off>>3;else if(this.m_off<=16384){if(this.m_off-=1,this.m_len<=33)this.out[this.op++]=32|this.m_len-2;else{for(this.m_len-=33,this.out[this.op++]=32;this.m_len>255;)this.m_len-=255,this.out[this.op++]=0;this.out[this.op++]=this.m_len}this.out[this.op++]=this.m_off<<2,this.out[this.op++]=this.m_off>>6}else{if(this.m_off-=16384,this.m_len<=9)this.out[this.op++]=16|this.m_off>>11&8|this.m_len-2;else{for(this.m_len-=9,this.out[this.op++]=16|this.m_off>>11&8;this.m_len>255;)this.m_len-=255,this.out[this.op++]=0;this.out[this.op++]=this.m_len}this.out[this.op++]=this.m_off<<2,this.out[this.op++]=this.m_off>>6}}else this.ip+=1+(this.ip-this.jj>>5);this.t=this.ll-(this.jj-this.ip_start-this.ti)},this.compress=function(e){for(this.state=e,this.ip=0,this.buf=this.state.inputBuffer,this.maxSize=this.buf.length+Math.ceil(this.buf.length/16)+64+3,this.maxSize>this.out.length&&(this.out=new Uint8Array(this.maxSize)),this.op=0,this.l=this.buf.length,this.t=0;this.l>20&&(this.ll=this.l<=49152?this.l:49152,!(this.t+this.ll>>5<=0));)this.dict.set(this.emptyDict),this.prev_ip=this.ip,this._compressCore(),this.ip=this.prev_ip+this.ll,this.l-=this.ll;if(this.t+=this.l,this.t>0){if(this.ii=this.buf.length-this.t,0===this.op&&this.t<=238)this.out[this.op++]=17+this.t;else if(this.t<=3)this.out[this.op-2]|=this.t;else if(this.t<=18)this.out[this.op++]=this.t-3;else{for(this.tt=this.t-18,this.out[this.op++]=0;this.tt>255;)this.tt-=255,this.out[this.op++]=0;this.out[this.op++]=this.tt}do{this.out[this.op++]=this.buf[this.ii++]}while(--this.t>0)}return this.out[this.op++]=17,this.out[this.op++]=0,this.out[this.op++]=0,this.state.outputBuffer=!0===this.returnNewBuffers?new Uint8Array(this.out.subarray(0,this.op)):this.out.subarray(0,this.op),this.OK}};return{setBlockSize:function(t){return e.setBlockSize(t)},setOutputEstimate:function(t){return e.setOutputSize(t)},setReturnNewBuffers:function(t){e.setReturnNewBuffers(t)},compress:function(t,s){return void 0!==s&&e.applyConfig(s),e.compress(t)},decompress:function(t,s){return void 0!==s&&e.applyConfig(s),e.decompress(t)}}}();!function(e,t){"use strict";var s=null,i="PointerEvent"in e||e.navigator&&"msPointerEnabled"in e.navigator,n="ontouchstart"in e||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0,l=i?"pointerdown":n?"touchstart":"mousedown",o=i?"pointerup":n?"touchend":"mouseup",a=i?"pointermove":n?"touchmove":"mousemove",r=i?"pointerleave":n?"touchleave":"mouseleave",c=0,d=0;function h(e){u(),e=function(e){return void 0!==e.changedTouches?e.changedTouches[0]:e}(e),this.dispatchEvent(new CustomEvent("long-press",{bubbles:!0,cancelable:!0,detail:{clientX:e.clientX,clientY:e.clientY,offsetX:e.offsetX,offsetY:e.offsetY,pageX:e.pageX,pageY:e.pageY},clientX:e.clientX,clientY:e.clientY,offsetX:e.offsetX,offsetY:e.offsetY,pageX:e.pageX,pageY:e.pageY,screenX:e.screenX,screenY:e.screenY}))||t.addEventListener("click",(function e(s){t.removeEventListener("click",e,!0),function(e){e.stopImmediatePropagation(),e.preventDefault(),e.stopPropagation()}(s)}),!0)}function m(i){u(i);var n=i.target,l=parseInt(function(e,s,i){for(;e&&e!==t.documentElement;){var n=e.getAttribute("data-long-press-delay");if(n)return n;e=e.parentNode}return"600"}(n),10);s=function(t,s){if(!(e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame&&e.mozCancelRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame))return e.setTimeout(t,s);var i=(new Date).getTime(),n={},l=function(){(new Date).getTime()-i>=s?t.call():n.value=requestAnimFrame(l)};return n.value=requestAnimFrame(l),n}(h.bind(n,i),l)}function u(t){var i;(i=s)&&(e.cancelAnimationFrame?e.cancelAnimationFrame(i.value):e.webkitCancelAnimationFrame?e.webkitCancelAnimationFrame(i.value):e.webkitCancelRequestAnimationFrame?e.webkitCancelRequestAnimationFrame(i.value):e.mozCancelRequestAnimationFrame?e.mozCancelRequestAnimationFrame(i.value):e.oCancelRequestAnimationFrame?e.oCancelRequestAnimationFrame(i.value):e.msCancelRequestAnimationFrame?e.msCancelRequestAnimationFrame(i.value):clearTimeout(i)),s=null}"function"!=typeof e.CustomEvent&&(e.CustomEvent=function(e,s){s=s||{bubbles:!1,cancelable:!1,detail:void 0};var i=t.createEvent("CustomEvent");return i.initCustomEvent(e,s.bubbles,s.cancelable,s.detail),i},e.CustomEvent.prototype=e.Event.prototype),e.requestAnimFrame=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t){e.setTimeout(t,1e3/60)},t.addEventListener(o,u,!0),t.addEventListener(r,u,!0),t.addEventListener(a,(function(e){var t=Math.abs(c-e.clientX),s=Math.abs(d-e.clientY);(t>=10||s>=10)&&u()}),!0),t.addEventListener("wheel",u,!0),t.addEventListener("scroll",u,!0),t.addEventListener(l,(function(e){c=e.clientX,d=e.clientY,m(e)}),!0)}(window,document);